name: Python Release

# ------------------------------------------------------------
# Trigger release automation only on pushes to main
# (Release Please will decide if a release is needed)
# ------------------------------------------------------------
on:
  workflow_dispatch:
  push:
    branches:
      - main

# ------------------------------------------------------------
# Required permissions for Release Please
# ------------------------------------------------------------
permissions:
  # Needed to create Git tags and GitHub releases
  contents: write

  # Needed to open / update release PRs
  pull-requests: write

# ------------------------------------------------------------
# Release automation job
# ------------------------------------------------------------
jobs:
  release-please:
    runs-on: ubuntu-latest

    steps:
      # --------------------------------------------------------
      # Run Release Please
      # - Detects conventional commits
      # - Updates CHANGELOG.md
      # - Bumps version in pyproject.toml
      # - Creates release PR OR GitHub release
      # --------------------------------------------------------
      - name: Run Release Please
        uses: googleapis/release-please-action@v4
        with:
          config-file: .github/release-please-config.json
